<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./rockScissorsPaper.css" />
    <title>Document</title>
  </head>
  <body>
    <div class="container">
      <div class="inner-container">
        <h1>ê°€ìœ„ ë°”ìœ„ ë³´</h1>
        <div id="startOrGame">
          <button id="startBtn">ì‹œì‘í•˜ê¸°!</button>
        </div>
        <div class="button-wrapper">
          <button class="player-buttons" id="item1">ê°€ìœ„</button>
          <button class="player-buttons" id="item2">ë°”ìœ„</button>
          <button class="player-buttons" id="item3">ë³´</button>
        </div>
      </div>
      <div class="modal-box">
        <div class="modal-outer-box">
          <div class="modal-inner-box">
            <h2>ê²°ê³¼ ë°œí‘œ</h2>
            <div id="result-show"></div>
            <button class="reload-game">ë‹¤ì‹œí•˜ê¸°</button>
          </div>
        </div>
      </div>
    </div>
    <script>
      let pcItem = ""; // ë¨ë¤ ê°€ìœ„ë°”ìœ„ë³´ê°€ ì €ì¥ë˜ëŠ” ë³€ìˆ˜
      let timer = 0; // setIntervalì„ ìœ„í•œ íƒ€ì´ë¨¸ -> .3ì´ˆë§ˆë‹¤ changeVal ì‹¤í–‰
      let result = ""; // ê°€ìœ„ë°”ìœ„ë³´ ê²°ê³¼ê°€ ì €ì¥ë˜ëŠ” ë³€ìˆ˜
      const startBtn = document.querySelector("#startBtn");
      const emoticons = ["âœŒï¸", "âœŠ", "ğŸ–ï¸"];

      function getRandom() {
        // 0ë¶€í„° 2ê¹Œì§€ ë‚œìˆ˜ ìƒì„±
        return Math.floor(Math.random() * 3);
      }

      const changeToImg = document.querySelector("#startOrGame");
      const emoticon = document.createElement("p");
      emoticon.className = "emoticon-p";

      function changeVal() {
        // randomìˆ«ìë¥¼ ë½‘ì•„ì„œ í™”ë©´ì— ì¶œë ¥, pcItem ê°’ ì €ì¥
        const randomVal = getRandom();
        pcItem = randomVal;
        emoticon.innerText = emoticons[randomVal];
      }

      function startGame() {
        // ê²Œì„ì´ ì²˜ìŒ ì‹œì‘ë˜ë©´ ì‹¤í–‰ë˜ëŠ” í•¨ìˆ˜
        // ì‹œì‘ ë²„íŠ¼ì„ ì‚­ì œí•˜ê³  ëŒ€ì‹  í™”ë©´ì— ê°€ìœ„ë°”ìœ„ë³´ ì´ë¯¸ì§€ë¥¼ ë³´ì—¬ì¤„ tag ì¶”ê°€
        changeToImg.removeChild(startBtn);
        changeToImg.appendChild(emoticon);

        // setIntervalì„ í™œìš©í•˜ì—¬ íŠ¹ì • ì‹œê°„ë§ˆë‹¤ ìƒˆë¡œìš´ ëœë¤ ê°’ ë½‘ê¸°
        timer = setInterval(changeVal, 300);
      }

      startBtn.addEventListener("click", startGame);

      const buttonWrapper =
        document.getElementsByClassName("button-wrapper")[0];
      const scissorBtn = document.getElementById("item1");
      const rockBtn = document.getElementById("item2");
      const paperBtn = document.getElementById("item3");

      // ê°€ìœ„, ë°”ìœ„, ë³´ ë²„íŠ¼ ì¤‘ì—ì„œ í•˜ë‚˜ í´ë¦­ì‹œ resultê³„ì‚° í›„ ê²°ê³¼ë¥¼ modalì°½ìœ¼ë¡œ ë³´ì—¬ì¤Œ
      buttonWrapper.addEventListener("click", function (e) {
        let playerItem = "";
        if (e.target === scissorBtn) {
          playerItem = 0;
        } else if (e.target === rockBtn) {
          playerItem = 1;
        } else if (e.target === paperBtn) {
          playerItem = 2;
        } else {
          return;
        }
        result = calculate(playerItem, pcItem);
        showResultModal();
      });

      function calculate(player, pc) {
        // ê²°ê³¼ë¥¼ ê³„ì‚°í•˜ëŠ” í•¨ìˆ˜
        // ê°€ìœ„, ë°”ìœ„, ë³´ -> 1, 2, 3
        clearInterval(timer); // ê²Œì„ì„ ì¤‘ì§€í•  ê²ƒì´ê¸° ë•Œë¬¸ì— timerì„ ì •ì§€ì‹œí‚´
        let result = player - pc;
        if (result === 0) {
          // playerê³¼ pcê°€ ê°’ì´ ê°™ìœ¼ë©´ ê°™ì€ ê°’ì„ ì„ íƒí–ˆë‹¤ëŠ” ê²ƒì´ë¯€ë¡œ ë¬´ìŠ¹ë¶€
          return "ë¬´ìŠ¹ë¶€";
        } else if (result === 1 || result === -2) {
          // ê°€ìœ„ë°”ìœ„ë³´ ìˆœì„œì¼ ë•Œ, 1 ì°¨ì´ê°€ ë‚œë‹¤ëŠ” ê²ƒì€ ë‚´ê°€ ë‚´ê°€ ì£¼ë¨¹ì¼ ë•Œ, pcê°€ ê°€ìœ„ë¼ëŠ” ê²ƒ, ë‚´ê°€ ë³´ì¼ ë•Œ, pcê°€ ì£¼ë¨¹ì´ë¼ëŠ” ê²ƒ
          // -2ì°¨ì´ ë‚œë‹¤ëŠ” ê²ƒì€ ë‚´ê°€ ê°€ìœ„ì¼ ë•Œ, pcê°€ ë³´ë¼ëŠ” ê²ƒì„ ì˜ë¯¸í•˜ë¯€ë¡œ ì‚¬ìš©ìê°€ ìŠ¹ë¦¬
          return "í”Œë ˆì´ì–´ ìŠ¹ë¦¬!";
        } else {
          // ê·¸ ì™¸ëŠ” ì‚¬ìš©ìê°€ íŒ¨ë°°í•œ ê²°ê³¼ì„
          return "í”Œë ˆì´ì–´ íŒ¨ë°°ã… ã… ";
        }
      }

      const modalBox = document.querySelector(".modal-box");
      const modal = document.querySelector(".modal");
      const resultTitle = document.querySelector("#result-show");

      function showResultModal() {
        resultTitle.innerHTML = `
          ${result}
        `;

        modalBox.classList.add("show"); // ì›ë˜ëŠ” displayë¥¼ noneìœ¼ë¡œ í–ˆë‹¤ê°€, ê²°ê³¼ë¥¼ ë³´ì—¬ì£¼ê³  ì‹¶ì„ ë•ŒëŠ” showë¼ëŠ” í´ë˜ìŠ¤ë¥¼ ì¶”ê°€í•˜ì—¬ í•´ë‹¹ í´ë˜ìŠ¤ë¥´ opacityë¥¼ 1ë¡œ ì£¼ë©´ì„œ í™”ë©´ì— ë³´ì—¬ì§€ê²Œ í•¨
      }
      const restartBtn = document.querySelector(".reload-game");
      restartBtn.addEventListener("click", function (e) {
        modalBox.classList.remove("show"); // ë‹¤ì‹œ ëª¨ë‹¬ì„ ì•ˆ ë³´ì´ê²Œ í•  ë•ŒëŠ” 'show' í´ë˜ìŠ¤ ì´ë¦„ì„ ì‚­ì œ
        restartGame();
      });
      function restartGame() {
        // pcItemê³¼ ê²°ê³¼ë¥¼ ì´ˆê¸°í™”í•˜ê³  ë‹¤ì‹œ changeVal í•¨ìˆ˜ë¥¼ ì‹¤í–‰
        pcItem = "";
        result = "";
        timer = setInterval(changeVal, 300);
      }
    </script>
  </body>
</html>
